# redis_mq

## 使用redis实现消息队列案例

> 使用redis的list的FIFO的特性(pop/push), 实现1个轻量级的消息队列. 关键点在于消息的ACK机制如何保证：

参考网上的文章: 

（1）若业务出现异常,直接在业务中进行回滚操作;

（2）消费者本身线程异常则需要另开线程做监听,然后回滚操作;

对应具体操作是：

新建1张数据表(tb_pending), 记录正在执行的消息(ID,THREAD_NAME,COMMIT_TIME). 若正常消费,在结束前删除该条消息的消费记录; 若业务异常,同样删除该记录并让消息重回队列中; 

线程定时做轮询去查询当前的tb_pending表中的消息消费记录, 是否存在消费超时(定义消费时间)的消息, 若存在则删除该记录并让其重回redis队列.
